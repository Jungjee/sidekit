

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Run a SVM-GMM system &mdash; SIDEKIT 0.1.16 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="SIDEKIT 0.1.16 documentation" href="../index.html"/>
        <link rel="up" title="RSR2015" href="RSR2015.html"/>
        <link rel="next" title="NIST-SRE 2010" href="SRE10.html"/>
        <link rel="prev" title="Run a GMM-UBM system" href="rsr2015_gmm_ubm.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> SIDEKIT
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../aboutSIDEKIT.html">About SIDEKIT</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contact.html">Contact</a></li>
<li class="toctree-l2"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compatibilities.html">Compatibilities</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../howto.html">How to</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../install.html">Quick installation</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="shorttuto.html">Enter the SIDEKIT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="featureExtraction.html">Extract acoustic features</a></li>
<li class="toctree-l3"><a class="reference internal" href="ubmTraining.html">Train a Universal Background Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="factoranalysis.html">The unified Factor Analyser training</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorial.html">Start with a tutorial</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="RSR2015.html">RSR2015</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="rsr2015_init.html">Prepare to run experiments on RSR2015</a></li>
<li class="toctree-l4"><a class="reference internal" href="rsr2015_gmm_ubm.html">Run a GMM-UBM system</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="">Run a SVM-GMM system</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="SRE10.html">NIST-SRE 2010</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sre10_init.html">Prepare to run experiments on NIST-SRE 2010</a></li>
<li class="toctree-l4"><a class="reference internal" href="sre10_iv.html">Run an <cite>i</cite>-vector system</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sidekit.html">SIDEKIT</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sidekit_classes.html">Main Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../featuresserver.html">FeaturesServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mixture.html">Mixture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statserver.html">StatServer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sidekit_modules.html">Additional modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sidekit_io.html">sidekit_io</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iv_scoring.html">iv_scoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gmm_scoring.html">gmm_scoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sv_utils.html">sv_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../svm_training.html">svm_training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../svm_scoring.html">svm_scoring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../bosaris.html">The <strong>bosaris</strong> package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bosaris/license.html">BOSARIS License</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bosaris/detplot.html">DetPlot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bosaris/idmap.html">IdMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bosaris/key.html">Key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bosaris/ndx.html">Ndx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bosaris/plotwindow.html">PlotWindow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bosaris/scores.html">Scores</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../frontend.html">The <strong>frontend</strong> package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../frontend/features.html">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../frontend/io.html">io</a></li>
<li class="toctree-l3"><a class="reference internal" href="../frontend/normfeat.html">Normfeat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../frontend/vad.html">vad</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../libsvm.html">The <strong>libsvm</strong> package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../libsvm/libsvm_core.html">LIBSVM Core library</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Links.html">External links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../known_errors.html">Known errors and warnings</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">SIDEKIT</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../howto.html">How to</a> &raquo;</li>
      
          <li><a href="../tutorial.html">Start with a tutorial</a> &raquo;</li>
      
          <li><a href="RSR2015.html">RSR2015</a> &raquo;</li>
      
    <li>Run a SVM-GMM system</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorial/rsr2015_svm_gmm.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="run-a-svm-gmm-system">
<h1>Run a SVM-GMM system<a class="headerlink" href="#run-a-svm-gmm-system" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line">The script <code class="docutils literal"><span class="pre">rsr2015_svm-gmm.py</span></code> run an experiment on the male evaluation part of the RSR2015</div>
<div class="line">database. The protocols used here is based on the one described in [Larcher14].</div>
<div class="line">In this version, we only consider the non-target trials where impostors</div>
<div class="line">pronounce the correct text (Imp Correct).</div>
</div>
<div class="line-block">
<div class="line">The number of Target trials performed is then</div>
<div class="line">TAR correct: 10,244</div>
<div class="line">IMP correct: 573,664</div>
</div>
<p>[Larcher14] Anthony Larcher, Kong Aik Lee, Bin Ma and Haizhou Li,
&#8220;Text-dependent speaker verification: Classifiers, databases and RSR2015,&#8221;
in Speech Communication 60 (2014) 56–77</p>
<div class="topic">
<p class="topic-title first">Input/Output</p>
<p>Enter:</p>
<blockquote>
<div><ul class="simple">
<li>the number of distribution for the Gaussian Mixture Models</li>
<li>the root directory where the RSR2015 database is stored</li>
</ul>
</div></blockquote>
<p>Generates the following outputs:</p>
<blockquote>
<div><ul class="simple">
<li>a <code class="xref py py-mod docutils literal"><span class="pre">Mixture</span></code> in compressed pickle format (ubm)</li>
<li>a <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> of zero and first-order statistics (enroll_stat)</li>
<li>a <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> of zero and first-order statistics (back_stat)</li>
<li>a <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> of zero and first-order statistics (nap_stat)</li>
<li>a <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> of zero and first-order statistics (test_stat)</li>
<li>a <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> containing the super vectors of MAP adapted GMM models for each speaker (enroll_sv)</li>
<li>a <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> containing the super vectors of MAP adapted GMM models for each speaker (back_sv)</li>
<li>a <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> containing the super vectors of MAP adapted GMM models for each speaker (nap_sv)</li>
<li>a <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> containing the super vectors of MAP adapted GMM models for each speaker (test_sv)</li>
<li>a score file</li>
<li>a DET plot</li>
</ul>
</div></blockquote>
</div>
<p>First, loads the required PYTHON packages:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sidekit</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s">&#39;rsr2015_ubm-gmm.log&#39;</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
<p>Enter here your parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">distribNb</span> <span class="o">=</span> <span class="mi">128</span>  <span class="c"># number of Gaussian distributions for each GMM</span>
<span class="n">NAP</span> <span class="o">=</span> <span class="bp">True</span>  <span class="c"># activate the Nuisance Attribute Projection</span>
<span class="n">nap_rank</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">rsr2015Path</span> <span class="o">=</span> <span class="s">&#39;/lium/parolee/larcher/data/RSR2015_V1/&#39;</span>
</pre></div>
</div>
<p>Set default parameters for the <strong>RSR2015</strong> database:</p>
<div class="highlight-python"><div class="highlight"><pre>audioDir = os.path.join((rsr2015Path , &#39;/sph/male/&#39;)
</pre></div>
</div>
<p>Set the number of process to run in parallel. Default is the number of
cores of the machine minus one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Automatically set the number of parallel process to run.</span>
<span class="c"># The number of threads to run is set equal to the number of cores available</span>
<span class="c"># on the machine minus one or to 1 if the machine has a single core.</span>
<span class="n">nbThread</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Load <code class="xref py py-mod docutils literal"><span class="pre">IdMap</span></code>, <code class="xref py py-mod docutils literal"><span class="pre">Ndx</span></code>, <code class="xref py py-mod docutils literal"><span class="pre">Key</span></code> objects and lists that define the task.
Note that these files are generated when running <code class="docutils literal"><span class="pre">rsr2015_init.py</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="s">&#39;Load task definition&#39;</span><span class="p">)</span>
<span class="n">enroll_idmap</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">IdMap</span><span class="p">(</span><span class="s">&#39;task/3sesspwd_eval_m_trn.p&#39;</span><span class="p">)</span>
<span class="n">nap_idmap</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">IdMap</span><span class="p">(</span><span class="s">&#39;task/3sess-pwd_eval_m_nap.p&#39;</span><span class="p">)</span>
<span class="n">back_idmap</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">IdMap</span><span class="p">(</span><span class="s">&#39;task/3sess-pwd_eval_m_back.p&#39;</span><span class="p">)</span>
<span class="n">test_ndx</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">Ndx</span><span class="p">(</span><span class="s">&#39;task/3sess-pwd_eval_m_ndx.p&#39;</span><span class="p">)</span>
<span class="n">test_idmap</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">IdMap</span><span class="p">(</span><span class="s">&#39;task/3sess-pwd_eval_m_test.p&#39;</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">Key</span><span class="p">(</span><span class="s">&#39;task/3sess-pwd_eval_m_key.p&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;task/ubm_list.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inputFile</span><span class="p">:</span>
    <span class="n">ubmList</span> <span class="o">=</span> <span class="n">inputFile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Load data to train a Universal Background Model.
Audio files are process on the fly and acoustic features
are not saved to disk (see <span class="target" id="sre10">SRE10</span> tutorial to see how to save features
to disk). An empty <code class="xref py py-mod docutils literal"><span class="pre">Mixture</span></code> is then initialized and
an EM algorithm is run to estimate the UBM before saving it to disk:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">load_and_stack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ubmList</span><span class="p">),</span> <span class="n">nbThread</span><span class="p">)</span>
<span class="n">ubm</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">Mixture</span><span class="p">()</span>
<span class="n">llk</span> <span class="o">=</span> <span class="n">ubm</span><span class="o">.</span><span class="n">EM_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">distribNb</span><span class="p">,</span> <span class="n">numThread</span><span class="o">=</span><span class="n">nbThread</span><span class="p">)</span>
<span class="n">ubm</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;gmm/ubm.p&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Make use of the new UBM to compute the sufficient statistics of all enrolement sessions that should be used to train the
speaker GMM models, models for the SVM training blacklist, segments to train the NAP matrix and test segments.
An empty <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> is initialized. Statistics are then computed
in the <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code> which is then stored to disk:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Create a StatServer for the enrollment data and compute the statistics</span>
<span class="n">enroll_stat</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">StatServer</span><span class="p">(</span><span class="n">enroll_idmap</span><span class="p">)</span>
<span class="n">enroll_stat</span><span class="o">.</span><span class="n">accumulate_stat_parallel</span><span class="p">(</span><span class="n">ubm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">numThread</span><span class="o">=</span><span class="n">nbThread</span><span class="p">)</span>
<span class="n">enroll_stat</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;data/stat_rsr2015_male_enroll.p&#39;</span><span class="p">)</span>

<span class="n">back_stat</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">StatServer</span><span class="p">(</span><span class="n">back_idmap</span><span class="p">)</span>
<span class="n">back_stat</span><span class="o">.</span><span class="n">accumulate_stat_parallel</span><span class="p">(</span><span class="n">ubm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">numThread</span><span class="o">=</span><span class="n">nbThread</span><span class="p">)</span>
<span class="n">back_stat</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;data/stat_rsr2015_male_back.p&#39;</span><span class="p">)</span>

<span class="n">nap_stat</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">StatServer</span><span class="p">(</span><span class="n">nap_idmap</span><span class="p">)</span>
<span class="n">nap_stat</span><span class="o">.</span><span class="n">accumulate_stat_parallel</span><span class="p">(</span><span class="n">ubm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">numThread</span><span class="o">=</span><span class="n">nbThread</span><span class="p">)</span>
<span class="n">nap_stat</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;data/stat_rsr2015_male_nap.p&#39;</span><span class="p">)</span>

<span class="n">test_stat</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">StatServer</span><span class="p">(</span><span class="n">test_idmap</span><span class="p">)</span>
<span class="n">test_stat</span><span class="o">.</span><span class="n">accumulate_stat_parallel</span><span class="p">(</span><span class="n">ubm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">numThread</span><span class="o">=</span><span class="n">nbThread</span><span class="p">)</span>
<span class="n">test_stat</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;data/stat_rsr2015_male_test.p&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Train a GMM for each session. Only adapt the mean supervector and store all of them in the <code class="docutils literal"><span class="pre">enrol_sv</span></code> <code class="xref py py-mod docutils literal"><span class="pre">StatServer</span></code>
that is then stored in compressed picked format:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">regulation_factor</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c"># MAP regulation factor</span>

<span class="n">enroll_sv</span> <span class="o">=</span> <span class="n">enroll_stat</span><span class="o">.</span><span class="n">adapt_mean_MAP</span><span class="p">(</span><span class="n">ubm</span><span class="p">,</span> <span class="n">regulation_factor</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">enroll_sv</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;data/sv_rsr2015_male_enroll.p&#39;</span><span class="p">)</span>

<span class="n">back_sv</span> <span class="o">=</span> <span class="n">back_stat</span><span class="o">.</span><span class="n">adapt_mean_MAP</span><span class="p">(</span><span class="n">ubm</span><span class="p">,</span> <span class="n">regulation_factor</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">back_sv</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;data/sv_rsr2015_male_back.p&#39;</span><span class="p">)</span>

<span class="n">nap_sv</span> <span class="o">=</span> <span class="n">nap_stat</span><span class="o">.</span><span class="n">adapt_mean_MAP</span><span class="p">(</span><span class="n">ubm</span><span class="p">,</span> <span class="n">regulation_factor</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">nap_sv</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;data/sv_rsr2015_male_nap.p&#39;</span><span class="p">)</span>

<span class="n">test_sv</span> <span class="o">=</span> <span class="n">test_stat</span><span class="o">.</span><span class="n">adapt_mean_MAP</span><span class="p">(</span><span class="n">ubm</span><span class="p">,</span> <span class="n">regulation_factor</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">test_sv</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;data/sv_rsr2015_male_test.p&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If <code class="docutils literal"><span class="pre">NAP</span> <span class="pre">==</span> <span class="pre">True</span></code>, estimate and apply the Nuisance Attribute Projection on all supervectors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">NAP</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Estimate and apply NAP&#39;</span><span class="p">)</span>
    <span class="n">napMat</span> <span class="o">=</span> <span class="n">back_sv</span><span class="o">.</span><span class="n">get_nap_matrix_stat1</span><span class="p">(</span><span class="n">nap_rank</span><span class="p">);</span>
    <span class="n">back_sv</span><span class="o">.</span><span class="n">stat1</span> <span class="o">=</span> <span class="n">back_sv</span><span class="o">.</span><span class="n">stat1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">back_sv</span><span class="o">.</span><span class="n">stat1</span><span class="p">,</span> <span class="n">napMat</span><span class="p">),</span> <span class="n">napMat</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
    <span class="n">enroll_sv</span><span class="o">.</span><span class="n">stat1</span> <span class="o">=</span> <span class="n">enroll_sv</span><span class="o">.</span><span class="n">stat1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">enroll_sv</span><span class="o">.</span><span class="n">stat1</span><span class="p">,</span> <span class="n">napMat</span><span class="p">),</span> <span class="n">napMat</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
    <span class="n">test_sv</span><span class="o">.</span><span class="n">stat1</span> <span class="o">=</span> <span class="n">test_sv</span><span class="o">.</span><span class="n">stat1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">test_sv</span><span class="o">.</span><span class="n">stat1</span><span class="p">,</span> <span class="n">napMat</span><span class="p">),</span> <span class="n">napMat</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
</pre></div>
</div>
<p>Train a Support Vector Machine for each speaker by considering the three sessions of this speaker:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sidekit</span><span class="o">.</span><span class="n">svm_training</span><span class="p">(</span><span class="s">&#39;svm/&#39;</span><span class="p">,</span> <span class="n">back_sv</span><span class="p">,</span> <span class="n">enroll_sv</span><span class="p">,</span> <span class="n">numThread</span><span class="o">=</span><span class="n">nbThread</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute the scores for all trials:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="s">&#39;Compute trial scores&#39;</span><span class="p">)</span>
<span class="n">scores_gmm_svm</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">svm_scoring</span><span class="p">(</span><span class="s">&#39;svm/&#39;</span><span class="p">,</span> <span class="n">test_sv</span><span class="p">,</span> <span class="n">test_ndx</span><span class="p">,</span> <span class="n">numThread</span><span class="o">=</span><span class="n">nbThread</span><span class="p">)</span>
<span class="k">if</span> <span class="n">NAP</span><span class="p">:</span>
    <span class="n">scores_gmm_svm</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;scores/scores_svm-gmm_NAP_rsr2015_male.p&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">scores_gmm_svm</span><span class="o">.</span><span class="n">save_pickle</span><span class="p">(</span><span class="s">&#39;scores/scores_svm-gmm_rsr2015_male.p&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the Detection Error Trade-off (DET) curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Set the prior following NIST-SRE 2008 settings</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">effective_prior</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c"># Initialize the DET plot to 2008 settings</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">sidekit</span><span class="o">.</span><span class="n">DetPlot</span><span class="p">(</span><span class="n">windowStyle</span><span class="o">=</span><span class="s">&#39;old&#39;</span><span class="p">,</span> <span class="n">plotTitle</span><span class="o">=</span><span class="s">&#39;SVM-GMM RSR2015 male&#39;</span><span class="p">)</span>
<span class="n">dp</span><span class="o">.</span><span class="n">set_system_from_scores</span><span class="p">(</span><span class="n">scores_gmm_svm</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">sys_name</span><span class="o">=</span><span class="s">&#39;SVM-GMM&#39;</span><span class="p">)</span>
<span class="n">dp</span><span class="o">.</span><span class="n">create_figure</span><span class="p">()</span>
<span class="n">dp</span><span class="o">.</span><span class="n">plot_rocch_det</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dp</span><span class="o">.</span><span class="n">plot_DR30_both</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dp</span><span class="o">.</span><span class="n">plot_mindcf_point</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The following plot should be obtained at the end of this tutorial without and with NAP</p>
<div class="figure">
<img alt="../_images/SVM-GMM_128g.png" src="../_images/SVM-GMM_128g.png" />
</div>
<div class="figure">
<img alt="../_images/SVM-GMM_NAP_128g.png" src="../_images/SVM-GMM_NAP_128g.png" />
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="SRE10.html" class="btn btn-neutral float-right" title="NIST-SRE 2010" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="rsr2015_gmm_ubm.html" class="btn btn-neutral" title="Run a GMM-UBM system" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Anthony LARCHER, Sylvain MEIGNIER &amp; Kong Aik LEE.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.16',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>